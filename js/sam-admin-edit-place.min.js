var sam=sam||{};!function(i){var t,e=samEditorOptions.media;sam.media=t={buttonId:"#banner-media",adUrl:"#patch_img",adImgId:"#patch_img_id",adName:"#title",adDesc:"#description",init:function(){i(this.buttonId).on("click",this.openMediaDialog)},openMediaDialog:function(i){return i.preventDefault(),this._frame?void this._frame.open():(this._frame=t.frame=wp.media({title:e.title,button:{text:e.button},multiple:!1,library:{type:"image, *flash*"}}),this._frame.on("ready",function(){}),this._frame.state("library").on("select",function(){var i=this.get("selection").single();t.handleMediaAttachment(i)}),void this._frame.open())},handleMediaAttachment:function(t){var e=t.toJSON();i(this.adUrl).val(e.url),i(this.adImgId).val(e.id),""==i(this.adName).val()&&""!=e.title&&i(this.adName).val(e.title),""==i(this.adDesc).val()&&""!=e.caption&&i(this.adDesc).val(e.caption),""==i(this.adAlt).val()&&""!=e.alt&&i(this.adAlt).val(e.alt)}},i(document).ready(function(){var e,a=(i("#editor_mode").val(),i("#rc-psi")),n=i("#rc-psc"),o=i("#rc-psd"),s=i("#title"),l=i("#place_id").val(),r=(i("#upload-file-button"),i("#uploading"),i("#uploading-help"),i("#load_img"),0),d=i("#ads-grid"),c=samEditorOptions.samStatsUrl,p=samEditorOptions.labels;e=samEditorOptions.places,e.pointer="places",t.init(),s.tooltip({track:!0});var h,m=samEditorOptions.options,u=[],v={animate:!1,animateReplot:!0,cursor:{showTooltip:!1},seriesDefaults:{pointLabels:{show:!0,xpadding:12,ypadding:-5,hideZeros:!0}},series:[{pointLabels:{location:"ne"},renderer:i.jqplot.BarRenderer,showHighlight:!1,rendererOptions:{barWidth:15,barPadding:-15,barMargin:0,highlightMouseOver:!1},label:p.hits},{label:p.clicks,yaxis:"y2axis",pointLabels:{location:"nw"}}],axesDefaults:{pad:1.2,min:0,tickOptions:{formatString:"%d"}},axes:{xaxis:{tickInterval:1,drawMajorGridlines:!1,drawMinorGridlines:!0,drawMajorTickMarks:!1,rendererOptions:{tickInset:1,minorTicks:1},pad:1,min:1},y2axis:{rendererOptions:{alignTicks:!0}}},legend:{show:!0,placement:"ne"}};return i.post(c,{action:"load_stats",id:l,sm:r}).done(function(t){u=[t.hits,t.clicks],i("#total_hits").text(t.total.hits),i("#total_clicks").text(t.total.clicks),h=i.jqplot("graph",u,v)}),i("#tabs").tabs({activate:function(t,e){var a=e.newPanel[0].id;"tabs-3"==a&&h&&(h.destroy(),h=i.jqplot("graph",u,v))}}),i(window).resize(function(){h&&(h.destroy(),h=i.jqplot("graph",u,v))}),i("#image_tools").tabs(),i.post(c,{action:"load_ads",id:l,sm:0}).done(function(i){var t=i.records;d.w2grid({name:"ads",show:{selectColumn:!1},multiSelect:!1,columns:samEditorOptions.columns,records:t})}),i("#add-file-button").click(function(){var t=m.url+i("select#files_list option:selected").val();return i("#patch_img").val(t),!1}),i("#patch_source_image").click(function(){a.is(":hidden")&&a.show("blind",{direction:"vertical"},500),n.is(":visible")&&n.hide("blind",{direction:"vertical"},500),o.is(":visible")&&o.hide("blind",{direction:"vertical"},500)}),i("#patch_source_code").click(function(){a.is(":visible")&&a.hide("blind",{direction:"vertical"},500),n.is(":hidden")&&n.show("blind",{direction:"vertical"},500),o.is(":visible")&&o.hide("blind",{direction:"vertical"},500)}),i("#patch_source_dfp").click(function(){a.is(":visible")&&a.hide("blind",{direction:"vertical"},500),n.is(":visible")&&n.hide("blind",{direction:"vertical"},500),o.is(":hidden")&&o.show("blind",{direction:"vertical"},500)}),(e.enabled||""==s.val())&&s.pointer({content:"<h3>"+e.title+"</h3><p>"+e.content+"</p>",position:"top",close:function(){i.ajax({url:ajaxurl,data:{action:"close_sam_pointer",pointer:e.pointer},async:!0})}}).pointer("open"),i("#stats_month").change(function(){r=i(this).val(),i.post(c,{action:"load_stats",id:l,sm:r}).done(function(t){u=[t.hits,t.clicks],i("#total_hits").text(t.total.hits),i("#total_clicks").text(t.total.clicks),h&&(h.destroy(),h=i.jqplot("graph",u,v))})}),!1})}(jQuery);